version: '3'

services:
  nginx-proxy:
    image: jwilder/nginx-proxy:alpine
    ports:
      - 80:80
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock:ro
    restart: unless-stopped

  gatsby:
    build:
      context: ./
    volumes:
      - ./:/app
      - ~/Sites/.docker/yarn-cache:/root/.yarn-cache
    environment:
      VIRTUAL_HOST: michaelfitzpatrick.loc
      VIRTUAL_PORT: 3101
    ports:
      - 3101:80
